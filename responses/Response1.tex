\documentclass[12pt,a4paper, onesided]{article}
% !TeX program=pdflatex
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{lmodern}
\usepackage[american]{babel}

\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage{xcolor}

\usepackage{fancyhdr}
\pagestyle{fancy}
\fancyhf{}
\rhead{Submission ID FLD-24-0080}
\rfoot{\thepage}
\setlength\parindent{0pt}

\newcommand{\SG}[1]{{\color{red}SG:~#1}}
\newcommand{\SJM}[1]{{\color{orange}SM:~#1}}
\newcommand{\SW}[1]{{\color{purple}SW:~#1}}
\newcommand{\RK}[1]{{\color{cyan}RK: #1}}

\usepackage[
backend=bibtex,
citestyle=numeric-comp,
maxbibnames=10,
sorting=none
]{biblatex}
\addbibresource{../assets/bib/bib.bib}

\usepackage[locale=US]{siunitx}
\sisetup{per-mode=fraction}
\sisetup{separate-uncertainty=true}


\newcommand*{\referee}[1]{%
    \small
    \begin{quote} 
        \textsf{#1}
    \end{quote}
    \normalsize
}

\begin{document}
\section*{Response to Referee 1}

\referee{What are the parameters $\eta_0$ and $\eta_ \infty $ appeared in Eq. (7)?}

The parameters $\eta_0$ and $\eta_\infty$ are the viscosities for zero and infinite shear rates, respectively.
We now mention this just before Eq. (7).

\referee{Please provide more details on the elements of the lattice Boltzmann method, for instance, lattice model considered in this work, the discrete velocities and the equilibrium populations.}

We have added a new appendix E where we discuss the LB method in general as well as our specific implementation details.

\referee{The authors should provide the relation between the relaxation time and viscosity appeared in first term on the right-hand side of Eq. (12). In addition, if Eq. (12) is considered, should the term $B_i$ given by Eq. (9) be modified?}

As mentioned below eq (12) this viscosity is used for the LBM solver, therefore the standard LBM relation (see new appendix) applies to this viscosity.
To reduce ambiguity between equations (9) and (12), we introduced a prime into the notation and consequently Eq (9) has been (slightly) modified and the text below has been expanded for clarity. 
A reference to $\tau^\prime$ has been introduced below eq (12) as well.

\referee{Is the relaxation time $\tau_r=1$ adopted in numerical simulations?}

Yes, as we now mention in the new appendix E.

\referee{Why is the finite-volume method adopted for polymer stress? Please give some details on the finite-volume method. In addition, it is known that in the lattice Boltzmann method, the square or cubic lattice is adopted, and thus the finite-difference method seems a better choice?}

Our choice of the finite-volume method is motivated primarily by its clarity and simplicity when implementing complex boundary conditions.
Furthermore, the finite-volume method matches well with the so-called corner-transport-upwind (CTU) scheme which we use for advection and for which earlier works \cite{kuron2021} reported increased stability.
To make these points clearer to the reader, we added many corresponding details to section 4.2 of the revised manuscript.
%Finite difference is a lot harder to implement (boundary conditions), has a lot more loose ends to tie (to assure conservation for example) and is less stable.

\referee{As seen from Fig. 4, there is an apparent difference between the numerical results and semi-analytical solution, especially in the center part of the channel. Please give some explanations on this point.}

As in most LBM simulations, an important source of error is the discretisation of the boundary.
When discretising a physically round boundary such as the cylinder in figure 4 on a cubic lattice, the boundary shape necessarily becomes imprecise - the so-called ''staircase'' effect.
As can be seen in figure 14, the relative error is indeed largest near the wall.
We therefore explain the - apparently - large error in the center in figure 4 by a propagation of discretisation errors into the fluid.

%As can be seen from Fig. 3 this discrepancy is only present in 3D. 
%As the 2D case was simulated using the same algorithm technically also in 3D (periodic on the extra axis), the only difference between the simulations is the geometry. 
%The error is actually largest on the walls (see figure 14). 
%As stated between figure 3 and 4, the approximation of a round channel using a cubic lattice introduces a staircase-effect resulting in significant error near the walls. 
%These errors of course propagate to the center.

\referee{In the framework of lattice Boltzmann method, the multiple-relaxation-time (MRT) model can be considered to improve the numerical stability. Can MRT model be adopted in this work to overcome the numerical instability problem?}

MRT is considered to improve numerical stability of time dependent or turbulent flow in high $Re$ cases \cite{dzanic2022, Kruger_book}, it is used for $Re = \num{100}$ \cite{chai2011} and above \cite{dhumieres2002}. 
As the problem discussed in the present work has very low $Re$, it would not be expected to improve stability here. 
Consequently, SRT is used by all authors we list in our literature overview except for Kuron et al. (TRT) \cite{kuron2021} and Gupta et al. (MRT) \cite{gupta2015}. 
Notably, while Gupta et al. use MRT their method achieves the lowest $max\left(R_\eta\right)$ in our overview, which leads us to believe that MRT does not lead to stability improvement for low Reynolds viscoelastic situations such as ours.

To confirm the above hints from the literature, we have done ourselves some tests with MRT (which is implemented in our code) but could not find any stability improvement. 
We now mention this in the revised manuscript in section 4.1.


%MRT gets a lot more credit than it deserves.
%If tuned for a specific problem it can marginally improve stability. 
%The stability issues discussed in the present work arise at $R_\eta$ between 1 and 10, for realistic fluids we need to reach nearly 50k (alignate). 
%MRT might be able to help if the algorithm is nearly stable anyway. 
%For the issue presented here the classical approach is no where near stable. 
%We do have MRT implemented and can switch it on with a single flag. 
%We practically never do, because it is generally not worth the overhead.

\printbibliography[heading=bibintoc]

\end{document}
